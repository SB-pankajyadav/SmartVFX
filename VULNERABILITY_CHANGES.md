# Vulnerability Changes Report

**Generated:** February 23, 2026  
**Project:** vulnerable-node20-app

## Summary

This document tracks the security vulnerabilities in the project and the changes required to fix them.

### Current Vulnerability Status

| Severity | Count |
|----------|-------|
| ðŸ”´ High | 16 |
| ðŸŸ  Moderate | 2 |
| ðŸŸ¡ Low | 2 |
| **Total** | **20** |

---

## ðŸ“Š Vulnerability Breakdown by Package

### ðŸ”´ HIGH SEVERITY (16 vulnerabilities)

#### 1. **express** (4.12.4 â†’ 4.22.1)

**Current Version:** `4.12.4`  
**Fixed Version:** `4.22.1`  
**Severity:** HIGH  
**Is Direct Dependency:** âœ… Yes

**Vulnerabilities:**
- **XSS via response.redirect()** (GHSA-qw6h-vgh9-j6wx)
  - CVSS: 5.0 | CWE-79
  - Affects: <4.20.0
  
- **Open Redirect in malformed URLs** (GHSA-rv95-896h-c2vc)
  - CVSS: 6.1 | CWE-601, CWE-1286
  - Affects: <4.19.2

**Fix:**
```json
// BEFORE
"express": "4.12.4"

// AFTER
"express": "4.22.1"
```

---

#### 2. **body-parser** (1.19.0 â†’ 1.20.4)

**Current Version:** `1.19.0`  
**Fixed Version:** `1.20.4`  
**Severity:** HIGH  
**Is Direct Dependency:** âœ… Yes

**Vulnerabilities:**
- **Denial of Service when URL encoding is enabled** (GHSA-qwcr-r2fm-qrc7)
  - CVSS: 7.5 | CWE-405
  - Affects: <1.20.3

**Fix:**
```json
// BEFORE
"body-parser": "1.19.0"

// AFTER
"body-parser": "1.20.4"
```

---

#### 3. **jsonwebtoken** (8.5.1 â†’ 9.0.3)

**Current Version:** `8.5.1`  
**Fixed Version:** `9.0.3`  
**Severity:** HIGH  
**Is Direct Dependency:** âœ… Yes

**Vulnerabilities:**
- **Unrestricted key type could lead to legacy keys usage** (GHSA-8cf7-32gw-wr33)
  - CVSS: 8.1 | CWE-327
  - Affects: <=8.5.1
  
- **Insecure key retrieval - RSA to HMAC forgery** (GHSA-hjrf-2m68-5959)
  - CVSS: 5.0 | CWE-287, CWE-1259
  - Affects: <=8.5.1
  
- **Signature validation bypass** (GHSA-qwph-4952-7xr6)
  - CVSS: 6.4 | CWE-287, CWE-327, CWE-347
  - Affects: <9.0.0

**Fix:**
```json
// BEFORE
"jsonwebtoken": "8.5.1"

// AFTER
"jsonwebtoken": "9.0.3"
```

**âš ï¸ Note:** This is a **MAJOR** version upgrade - review API changes.

---

#### 4. **lodash** (4.17.15 â†’ 4.17.23)

**Current Version:** `4.17.15`  
**Fixed Version:** `4.17.23`  
**Severity:** HIGH  
**Is Direct Dependency:** âœ… Yes

**Vulnerabilities:**
- **Command Injection** (GHSA-35jh-r3h4-6jhm)
  - CVSS: 7.2 | CWE-77, CWE-94
  - Affects: <4.17.21
  
- **Prototype Pollution** (GHSA-p6mc-m468-83gw)
  - CVSS: 7.4 | CWE-770, CWE-1321
  - Affects: >=3.7.0 <4.17.19
  
- **Regular Expression Denial of Service (ReDoS)** (GHSA-29mw-wpgm-hmr9)
  - CVSS: 5.3 | CWE-400, CWE-1333
  - Affects: >=4.0.0 <4.17.21
  
- **Prototype Pollution in _.unset and _.omit** (GHSA-xxjr-mmjv-4gpg)
  - CVSS: 6.5 | CWE-1321
  - Affects: >=4.0.0 <=4.17.22

**Fix:**
```json
// BEFORE
"lodash": "4.17.15"

// AFTER
"lodash": "4.17.23"
```

---

#### 5. **mongoose** (4.2.4 â†’ 9.2.1)

**Current Version:** `4.2.4`  
**Fixed Version:** `9.2.1`  
**Severity:** HIGH (through dependencies)  
**Is Direct Dependency:** âœ… Yes

**Affected Through:**
- `debug` - Regular Expression DoS (CVSS: 7.5)
- `kerberos` - DLL Injection (CVSS: 7.8)
- `mpath` - Prototype Pollution (CVSS: 7.5)
- `mquery` - Code Injection (CVSS: 5.3)
- `ms` - Regular Expression Complexity (CVSS: 5.3)

**Fix:**
```json
// BEFORE
"mongoose": "4.2.4"

// AFTER
"mongoose": "9.2.1"
```

**âš ï¸ Note:** This is a **MAJOR** version upgrade (4.x â†’ 9.x) - significant API changes expected.

---

#### 6. **Indirect Dependencies (Fixed via express upgrade)**

The following HIGH severity vulnerabilities are in indirect dependencies and will be fixed by upgrading express to 4.22.1:

- **accepts** (<=1.3.2)
  - Via: negotiator
  - ReDoS vulnerability
  
- **cookie** (<0.7.0)
  - Out of bounds characters acceptance
  
- **debug** (<=2.6.8)
  - Regular Expression Complexity
  
- **finalhandler** (<=1.0.5)
  - Via debug dependency
  
- **fresh** (<0.5.2)
  - Regular Expression DoS (CVSS: 7.5)
  
- **mime** (<1.4.1)
  - Regular Expression DoS (CVSS: 7.5)
  
- **negotiator** (<0.6.1)
  - Regular Expression DoS
  
- **path-to-regexp** (<=0.1.11)
  - Backtracking Regular Expressions (CVSS: 7.5)
  - ReDoS (CVSS: 7.5)
  
- **qs** (<=6.14.1)
  - Prototype Pollution (multiple instances)
  - DoS via memory exhaustion (CVSS: 7.5)
  
- **send** (<=0.18.0)
  - Template injection leading to XSS

---

### ðŸŸ  MODERATE SEVERITY (2 vulnerabilities)

#### 1. **got** (11.8.2 â†’ 11.8.6)

**Current Version:** `11.8.2`  
**Fixed Version:** `11.8.6`  
**Severity:** MODERATE  
**Is Direct Dependency:** âœ… Yes

**Vulnerabilities:**
- **Redirect to UNIX socket** (GHSA-pfrx-2q88-qq97)
  - CVSS: 5.3
  - Affects: <11.8.5

**Fix:**
```json
// BEFORE
"got": "11.8.2"

// AFTER
"got": "11.8.6"
```

---

#### 2. **ms** (<2.0.0)

**Current Version:** Various (via dependencies)  
**Fixed Version:** 2.0.0  
**Severity:** MODERATE  
**Is Direct Dependency:** âŒ No (via mongoose, debug, send)

**Vulnerabilities:**
- **Inefficient Regular Expression Complexity** (GHSA-w9mr-4mfr-499f)
  - CVSS: 5.3 | CWE-1333
  - Affects: <2.0.0

**Fix:** Automatically fixed when upgrading mongoose to 9.2.1

---

### ðŸŸ¡ LOW SEVERITY (2 vulnerabilities)

#### 1. **cookie** (<0.7.0)

**Severity:** LOW  
**Is Direct Dependency:** âŒ No (via express)

**Vulnerabilities:**
- **Accepts out of bounds characters** (GHSA-pxg6-pf52-xh8x)
  - CWE-74
  - Affects: <0.7.0

**Fix:** Automatically fixed when upgrading express to 4.22.1

---

#### 2. **serve-static** (<=1.16.0)

**Severity:** LOW  
**Is Direct Dependency:** âŒ No (via express)

**Vulnerabilities:**
- **Template injection leading to XSS** (GHSA-cm22-4g7w-348p)
  - CVSS: 5.0 | CWE-79
  - Affects: <1.16.0

**Fix:** Automatically fixed when upgrading express to 4.22.1

---

## ðŸ”§ Required Changes to package.json

### Complete Before/After Comparison

```json
// ===== BEFORE (Vulnerable) =====
{
  "dependencies": {
    "express": "4.12.4",
    "mongoose": "4.2.4",
    "body-parser": "1.19.0",
    "jsonwebtoken": "8.5.1",
    "lodash": "4.17.15",
    "got": "11.8.2"
  }
}

// ===== AFTER (Fixed) =====
{
  "dependencies": {
    "express": "4.22.1",
    "mongoose": "9.2.1",
    "body-parser": "1.20.4",
    "jsonwebtoken": "9.0.3",
    "lodash": "4.17.23",
    "got": "11.8.6"
  }
}
```

---

## ðŸ“‹ Implementation Checklist

- [ ] **1. Update express** (4.12.4 â†’ 4.22.1)
  - Fixes: 16 vulnerabilities (including indirect dependencies)
  - Risk: Low (minor version upgrade)
  
- [ ] **2. Update body-parser** (1.19.0 â†’ 1.20.4)
  - Fixes: 1 HIGH severity DoS vulnerability
  - Risk: Low (minor version upgrade)
  
- [ ] **3. Update lodash** (4.17.15 â†’ 4.17.23)
  - Fixes: 4 vulnerabilities (command injection, prototype pollution, ReDoS)
  - Risk: Low (patch version upgrade)
  
- [ ] **4. Update got** (11.8.2 â†’ 11.8.6)
  - Fixes: 1 MODERATE severity vulnerability
  - Risk: Low (patch version upgrade)
  
- [ ] **5. Update jsonwebtoken** (8.5.1 â†’ 9.0.3) âš ï¸
  - Fixes: 3 HIGH severity authentication vulnerabilities
  - Risk: **MEDIUM** (major version upgrade - test thoroughly)
  - **Action Required:** Review migration guide for breaking changes
  
- [ ] **6. Update mongoose** (4.2.4 â†’ 9.2.1) âš ï¸
  - Fixes: Multiple vulnerabilities in dependencies
  - Risk: **HIGH** (major version upgrade from 4.x to 9.x)
  - **Action Required:** Review API changes, update code, test extensively

---

## âš ï¸ Migration Warnings

### jsonwebtoken (8.x â†’ 9.x)

**Breaking Changes:**
- Default algorithm behavior changes
- Key retrieval function updates
- Signature validation improvements

**Required Actions:**
1. Review all `jwt.sign()` and `jwt.verify()` calls
2. Explicitly specify algorithms
3. Update error handling
4. Test all authentication flows

### mongoose (4.x â†’ 9.x)

**Breaking Changes:**
- Query API changes
- Promise handling updates
- Schema definition changes
- Connection management updates
- Deprecated methods removed

**Required Actions:**
1. Review all mongoose queries and models
2. Update promise chains to async/await
3. Update connection configuration
4. Test all database operations
5. Review and update middleware
6. Check plugin compatibility

---

## ðŸš€ Recommended Update Strategy

### Phase 1: Low Risk Updates (Do First)
```bash
npm install express@4.22.1 body-parser@1.20.4 lodash@4.17.23 got@11.8.6
```

### Phase 2: Medium Risk Updates (Test Thoroughly)
```bash
npm install jsonwebtoken@9.0.3
# Run full authentication test suite
# Review JWT implementation
```

### Phase 3: High Risk Updates (Requires Code Changes)
```bash
npm install mongoose@9.2.1
# Extensive code review required
# Update all mongoose-related code
# Comprehensive testing needed
```

---

## ðŸ§ª Testing Recommendations

After each phase:

1. **Unit Tests:** Run all unit tests
2. **Integration Tests:** Test database and API endpoints
3. **Security Tests:** Run `npm audit` to verify fixes
4. **Manual Testing:** Test critical user flows
5. **Performance Tests:** Ensure no performance degradation

---

## ðŸ“Š Expected Results After Fix

| Severity | Before | After | Reduction |
|----------|--------|-------|-----------|
| High | 16 | 0 | -16 |
| Moderate | 2 | 0 | -2 |
| Low | 2 | 0 | -2 |
| **Total** | **20** | **0** | **-20** |

---

## ðŸ“š Additional Resources

- [Express 4.x Migration Guide](https://expressjs.com/en/guide/migrating-4.html)
- [Mongoose 9.x Migration Guide](https://mongoosejs.com/docs/migrating_to_9.html)
- [jsonwebtoken 9.x Release Notes](https://github.com/auth0/node-jsonwebtoken/releases/tag/v9.0.0)
- [npm audit documentation](https://docs.npmjs.com/cli/v8/commands/npm-audit)

---

## ðŸ”’ Security Best Practices

After applying fixes:

1. **Regular Audits:** Run `npm audit` regularly
2. **Automated Scanning:** Set up automated vulnerability scanning in CI/CD
3. **Dependency Updates:** Keep dependencies up to date
4. **Security Policies:** Implement a security update policy
5. **Monitoring:** Monitor security advisories for your dependencies

---

*Last Updated: February 23, 2026*
